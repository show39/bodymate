.contents-wrapper
  %h1 #{@event.name}
  = link_to "ジャンル1", "#", class: "event-show-genre1"
  = link_to "ジャンル2", "#", class: "event-show-genre2"
  .row
    .col-md-8
      .left-contents
        = image_tag("event-image.jpg", alt: "イベントイメージ", class: "event-image")
        .event-description
          %p #{@event.description}
        .event-basicinfo
          %h2
            %span ■
            %p イベント情報
          %table
            %tr
              %th 開催日時
              - if @event.event_start.strftime("%Y%m%d") == @event.event_end.strftime("%Y%m%d")
                %td #{@event.event_start.strftime("%Y年%m月%d日 %H:%M")} 〜 #{@event.event_end.strftime("%H:%M")}
              - else
                %td #{@event.event_start.strftime("%Y年%m月%d日 %H:%M")} 〜 #{@event.event_end.strftime("%m月%d日 %H:%M")}
            %tr
              %th 開催場所
              %td
                #{@event.place}
                - if(@event.place_url)
                  = link_to('リンク', "#{@event.place_url}", target: "_blank")
            %tr
              %th 住所
              %td
                〒#{@event.postcode}<br />#{@event.prefecture}#{@event.city}#{@event.address1}#{@event.address2}
                - if(@event.map)
                  = link_to('マップ', "#{@event.map}", target: "_blank")
            %tr
              %th 募集状況
              %td
                - if(@event.recruit_start <= Time.now && @event.recruit_end >= Time.now)
                  募集中
                - elsif(@event.recruit_start >= Time.now)
                  募集前
                - else
                  終了
            %tr
              %th 募集期間
              %td #{@event.recruit_start.strftime("%Y年%m月%d日 %H:%M")} 〜 #{@event.recruit_end.strftime("%m月%d日 %H:%M")}
        .event-sentence
          %h2
            %span ■
            %p イベント内容
          .event-sentencebody= simple_format("#{@event.article}")
        .event-organizer
          %h2
            %span ■
            %p 主催者情報
          .attention ＊当イベントは下記の主催者によって企画・運営されており、Bodymateは関与しておりません。
          %table
            %tr
              %th 主催者
              %td #{@event.organizer}
            %tr
              %th 電話番号
              %td #{@event.tel}
            %tr
              %th メールアドレス
              %td
                = mail_to("#{@event.email}")
            - if(@event.organizer_url)
              %tr
                %th ホームページ
                %td
                  =link_to("#{@event.organizer_url}", "#{@event.organizer_url}", target: "_blank")
            %tr
              %th SNS
              %td
                - if(@event.facebook_url)
                  %span.organizer-facebook
                    = link_to(content_tag(:i, ' Facebook', class: "fa fa-facebook-square"), "#{@event.facebook_url}", target: "_blank")
                - if(@event.twitter_url)
                  %span.organizer-twitter
                    = link_to(content_tag(:i, ' Twitter', class: "fa fa-twitter-square"), "#{@event.twitter_url}", target: "_blank")
                - if(@event.instagram_url)
                  %span.organizer-instagram
                    = link_to(content_tag(:i, ' Instagram', class: "fa fa-instagram"), "#{@event.instagram_url}", target: "_blank")
    .col-md-4
      .right-contents
        - if(user_signed_in? && @event.user_id == current_user.id)
          .event-controllbtn
            .event-editbtn
              = link_to 'イベントを編集する', "/events/#{@event.id}/edit", method: :get
            .event-deletebtn{data:{target: "event-delete"}}
              = link_to 'イベントを削除する', 'javascript:void(0);'
        .event-tickets
          %h2
            %span ■
            %p チケット一覧
          - @tickets.each do |ticket|
            .ticket-box
              .ticket-name #{ticket.name}
              .ticket-price
                - if(ticket.price == 0)
                  %span 参加無料
                - else
                  %span 価格
                  %span ¥ #{ticket.price.to_s(:delimited)}
              .ticket-quantity
                %span 定員
                %span #{ticket.bookings.count}
                %span /
                %span #{ticket.quantity.to_s(:delimited)}
              - if Time.now >= ticket.event.recruit_start && Time.now <= ticket.event.recruit_end
                - if ticket.quantity <= ticket.bookings.count
                  .ticket-full
                    %p 満席
                - else
                  .ticket-bookingbtn{data:{target: "ticket-booking#{ticket.id}"}}
                    = link_to '予約モーダルを開く', 'javascript:void(0);'
              - else
                .ticket-end
                  %p 募集終了
            // チケット予約モーダル
            .ticket-booking.ticket-modal{id: "ticket-booking#{ticket.id}"}
              %h3 #{ticket.name}
              = form_for @booking do |f|
                .form-horizontal
                  .form-group
                    .field
                      %span.col.col-md-3.control-label
                        %span= f.label :お名前
                        %span.required 必須
                      .col.col-md-9
                        - if user_signed_in?
                          = f.text_field :name, class: "form-control", value: @user.name, required: true, maxlength: 20
                        - else
                          = f.text_field :name, class: "form-control", required: true, maxlength: 20
                  .form-group
                    .field
                      %span.col.col-md-3.control-label
                        %span= f.label :メールアドレス
                        %span.required 必須
                      .col.col-md-9
                        - if user_signed_in?
                          = f.email_field :email, class: "form-control", value: @user.email, required: true, maxlength: 50
                        - else
                          = f.email_field :email, class: "form-control", required: true, maxlength: 50
                  .form-group
                    .field
                      = f.label :コメント, class: "col col-md-3 control-label"
                      .col.col-md-9
                        = f.text_area :comment, class: "form-control booking-comment", rows: 2
                  = f.hidden_field :ticket_id, value: ticket.id
                  - if user_signed_in?
                    = f.hidden_field :user_id, value: @user.id
                  .form-grup
                    .actions
                      = f.submit 'このチケットを予約する', class: "booking-submit"
                  %p.attention ＊確認画面はありません。予約確定後に確認メールをお送りします。

  // イベント削除モーダル
  .eventdelete-modal#event-delete
    %p イベントは削除されますが、チケットの予約情報は残ります。
    %p イベントを削除してよろしいですか？
    .row.row-center
      .col-xs-6.center-block
        %span
          = form_for @event do |f|
            = f.hidden_field :del_flg, value: true
            = f.submit 'イベントを削除する'
      .col-xs-6.center-block
        %sapn
          .modal-cancel
            = link_to 'キャンセル', class: 'modal-close'
